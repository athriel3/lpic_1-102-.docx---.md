**105.3 Управление данными SQL**

Студент должен уметь составлять запросы к БД и управлять данными при
помощи основных SQL команд, в том числе объединять таблицы и
осуществлять выборки.

**Изучаем**:

- основные команды SQL;

- часто используемые действия, выполняемые при управлении БД.

**Администратор баз данных** - отдельная серьезная квалификация, однако
LPI просит разобраться с базами данных (БД) хотя бы поверхностно, для
понимания принципа их работы. Рассмотрим основные понятия, используемые
при работе с БД.

**База данных** упрощенно представляет с собой набор таблиц (часто
связанных между собой). В каждой таблице есть столбцы (поля), содержащие
значения определенного критерия, и строчки (записи), содержащие наборы
значений, относящиеся к одному объекту.

Для работы с БД используется язык **SQL** (structured query language).
Для создания и управления БД используется **СУБД** (система управления
базами данных). Существует несколько различных СУБД, в данном случае
рассматривается пакет ПО **mysql**.

Для возможности работы с БД необходимо установить СУБД, например,
***sudo apt-get install mysql-server** (при настройке пакета выйдет
запрос пароля для суперпользователя в mysql)*

Для создания БД необходимо перейти в режим управления mysql и выполнить
необходимые команды:

***Mysql --u root*** *(зайти от имени суперпользователя);*

***CREATE DATABASE cars;** (создать БД cars);*

***USE cars;*** *(начать работу с БД cars);*

***CREATE TABLE new (brand VARCHAR(10), model VARCHAR(10), year YEAR,
price INT);***

*(создать таблицу new с полями:*

*бренд, типа «символьное» длиной 10 символов;*

*модель, типа «символьное» длиной 10 символов;*

*год, типа «год»*

*цена, типа «целое число»*

*желательно еще добавить поле для уникальных значений типа
AUTO_INCREMENT);*

***CREATE TABLE used (brand VARCHAR(10), model VARCHAR(10), year YEAR,
price INT);***

*(создать таблицу used с полями, аналогично предыдущей таблице);*

***SHOW TABLES;** (вывести перечень созданных таблиц);*

***DESCRIBE new;** (вывести структуру таблицы new);*

***Exit;** (выйти из режима работы с mysql).*

*\_\_\_*

Данные в таблицы БД можно внести импортом из текстового файла.

Например создать файл **\~/new.txt** , в котором строчки будут являться
отдельными записями, значения полей в которых будут отделяться символом
табуляции, например:

***KIA CERATO 2014 780000***

Для возможности импорта информации необходимо выполнить команду:

***mysql \--local-infile=1 -u username***

После чего запустить импорт:

***USE cars;*** *(начать работу с БД cars);*

***LOAD DATA LOCAL INFILE \"new.txt\" INTO TABLE new;*** *(загрузить в
таблицу new данные из файла new.txt);*

***SELECT \* FROM new;*** *(выбрать все записи из таблицы new, что даст
нам возможность их увидеть);*

Также данные можно добавлять вручную, например:

***INSERT INTO new (brand, model, year) VALUES ('Daewoo', 'Nexia',
'2015');***

Или удалять по определенному критерию:

***DELETE FROM new WHERE model= 'Matiz'** (удалить все записи, в которых
моделью является Matiz);*

Для редактирования можно использовать команду UPDATE:

***UPDATE new SET model = 'KUGA' WHERE model = 'FOCUS'** (заменить в
таблице new в поле модель значения с KUGA на FOCUS)*

\_\_\_

Выборка информации из таблицы осуществляется командой SELECT, например:

***SELECT \* FROM new;** (выбрать все записи из таблицы new);*

***SELECT model FROM new;** (выбрать столбец model из таблицы new);*

***SELECT \* FROM new WHERE brand = "KIA";** (выбрать все записи из
таблицы new, у которых в поле brand стоит значение KIA);*

***SELECT \* FROM new WHERE brand = "KIA" AND year = "2015";** (выбрать
все записи из таблицы new, у которых в поле brand стоит значение KIA
[и]{.underline} в поле year - 2015);*

***SELECT \* FROM new JOIN used ON new.brand = used.brand ;** (выбрать
все записи из таблиц new и used, у которых значения поля brand
совпадают);*

***SELECT \* FROM new ORDER BY price;** (выбрать все записи из таблицы
new, и отсортировать их по цене);*

***SELECT \* FROM new GROUP BY brand;** (выбрать все записи из таблицы
new, и сгруппировать их по бренду).*
